<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{Title}}</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Consolas', 'Microsoft YaHei', monospace; background: #1a1a2e; color: #e0e0e0; padding: 20px; }
        .header { background: linear-gradient(135deg, #667eea, #764ba2); padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .header h1 { color: white; font-size: 24px; }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 15px; }
        .stat { background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; text-align: center; }
        .stat-label { font-size: 12px; color: #888; }
        .stat-value { font-size: 24px; font-weight: bold; color: white; margin-top: 5px; }
        .timeline-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .timeline-table th { background: #667eea; color: white; padding: 12px 8px; text-align: left; font-size: 12px; position: sticky; top: 0; }
        .timeline-table td { padding: 10px 8px; border-bottom: 1px solid rgba(255,255,255,0.1); font-size: 12px; vertical-align: top; }
        .timeline-table tr:hover { background: rgba(102, 126, 234, 0.1); }
        .index-cell { font-weight: bold; color: #667eea; min-width: 50px; }
        .time-cell { font-family: monospace; color: #4facfe; }
        .duration-cell { text-align: right; font-family: monospace; }
        .diff-cell { text-align: right; font-family: monospace; }
        .diff-positive { color: #fa709a; }
        .diff-negative { color: #43e97b; }
        .diff-ok { color: #888; }
        .speed-cell { text-align: center; }
        .speed-badge { padding: 2px 8px; border-radius: 4px; font-size: 11px; }
        .speed-ok { background: rgba(67, 233, 123, 0.2); color: #43e97b; }
        .speed-warning { background: rgba(250, 112, 154, 0.2); color: #fa709a; }
        .source-text { max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; color: #f093fb; }
        .target-text { max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; color: #43e97b; }
        .status-cell { min-width: 80px; }
        .status-badge { padding: 2px 8px; border-radius: 4px; font-size: 11px; }
        .status-generated { background: rgba(67, 233, 123, 0.2); color: #43e97b; }
        .status-failed { background: rgba(255, 107, 107, 0.2); color: #ff6b6b; }
        .status-pending { background: rgba(255, 255, 255, 0.1); color: #888; }
        .summary { margin-top: 20px; padding: 15px; background: rgba(102, 126, 234, 0.1); border-radius: 10px; border: 1px solid rgba(102, 126, 234, 0.3); }
        .summary h3 { color: #667eea; margin-bottom: 10px; }
        .summary-row { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .progress-container { margin-top: 20px; }
        .progress-bar { height: 20px; background: rgba(255,255,255,0.1); border-radius: 10px; overflow: hidden; display: flex; }
        .progress-segment { height: 100%; transition: width 0.3s; }
        .segment-source { background: linear-gradient(90deg, #f093fb, #f5576c); }
        .segment-target { background: linear-gradient(90deg, #43e97b, #38f9d7); }
        .segment-adjusted { background: linear-gradient(90deg, #fa709a, #fee140); }
        @media print { body { background: white; color: black; } .timeline-table th { background: #ddd; color: black; } }
    </style>
</head>
<body>
    <div class="header">
        <h1>â±ï¸ {{ProjectName}}</h1>
        <p>æ€»ç‰‡æ®µ: {{ClipCount}} ä¸ª | æ€»æ—¶é•¿: {{TotalDuration}}</p>
        <div class="stats">
            <div class="stat"><div class="stat-label">æºå­—å¹•æ€»æ—¶é•¿</div><div class="stat-value">{{SourceTotalDuration}}s</div></div>
            <div class="stat"><div class="stat-label">ç›®æ ‡éŸ³é¢‘æ€»æ—¶é•¿</div><div class="stat-value">{{TargetTotalDuration}}s</div></div>
            <div class="stat"><div class="stat-label">è°ƒæ•´åæ€»æ—¶é•¿</div><div class="stat-value">{{AdjustedTotalDuration}}s</div></div>
            <div class="stat"><div class="stat-label">å·²ç”Ÿæˆ</div><div class="stat-value">{{GeneratedCount}}/{{ClipCount}}</div></div>
            <div class="stat"><div class="stat-label">å·²è°ƒæ•´</div><div class="stat-value">{{AdjustedCount}}</div></div>
            <div class="stat"><div class="stat-label">é€Ÿåº¦å¼‚å¸¸</div><div class="stat-value" style="color: {{SpeedIssueColor}}">{{SpeedIssueCount}}</div></div>
        </div>
    </div>

    <div class="progress-container">
        <div style="margin-bottom: 5px; font-size: 12px; color: #888;">æ—¶é•¿åˆ†å¸ƒ:</div>
        <div class="progress-bar">
            {{ProgressSegments}}
        </div>
        <div style="display: flex; gap: 20px; margin-top: 8px; font-size: 11px;">
            <span><span style="display:inline-block;width:12px;height:12px;background:linear-gradient(90deg,#f093fb,#f5576c);border-radius:3px;margin-right:5px;"></span>æºå­—å¹• {{SourceTotalDuration}}s</span>
            <span><span style="display:inline-block;width:12px;height:12px;background:linear-gradient(90deg,#43e97b,#38f9d7);border-radius:3px;margin-right:5px;"></span>ç›®æ ‡éŸ³é¢‘ {{TargetTotalDuration}}s</span>
            <span><span style="display:inline-block;width:12px;height:12px;background:linear-gradient(90deg,#fa709a,#fee140);border-radius:3px;margin-right:5px;"></span>è°ƒæ•´å {{AdjustedTotalDuration}}s</span>
        </div>
    </div>

    <table class="timeline-table">
        <thead>
            <tr>
                <th>#</th>
                <th>æ—¶é—´èŒƒå›´</th>
                <th>æºæ—¶é•¿</th>
                <th>ç›®æ ‡æ—¶é•¿</th>
                <th>å·®å¼‚</th>
                <th>è°ƒæ•´å</th>
                <th>é€Ÿåº¦</th>
                <th>æºå­—å¹•</th>
                <th>ç›®æ ‡å­—å¹•</th>
                <th>çŠ¶æ€</th>
            </tr>
        </thead>
        <tbody>
            {{TableRows}}
        </tbody>
    </table>

    <div class="summary">
        <h3>ğŸ“Š ç»Ÿè®¡æ±‡æ€»</h3>
        {{SummaryRows}}
    </div>
</body>
</html>
